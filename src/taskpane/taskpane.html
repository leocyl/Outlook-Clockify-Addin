<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Clockify Integration</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>
<body class="ms-font-m ms-welcome ms-Fabric">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 col-md-8 offset-md-2">
          <!-- Collapsible Configuration Section -->
          <div class="card mb-3">
            <div class="card-header" id="configHeader">
              <h5 class="mb-0">
                <button class="btn btn-link" data-toggle="collapse" data-target="#configCollapse" aria-expanded="true" aria-controls="configCollapse">
                  <b>Clockify API Key and Workspace Settings</b>
                </button>
              </h5>
            </div>
            <div id="configCollapse" class="collapse show" aria-labelledby="configHeader">
              <div class="card-body">
                <!-- API Key Input -->
                <div id="settings" class="mb-3">
                  <h6>Enter Your Clockify API Key</h6>
                  <div class="input-group">
                    <input type="text" class="form-control" id="apiKey" placeholder="API Key" />
                    <div class="input-group-append">
                      <button id="saveApiKey" class="btn btn-primary">Save</button>
                    </div>
                  </div>
                </div>
                <!-- Workspace Selection -->
                <div id="workspaceSelection" style="display: none;">
                  <h6>Select Your Workspace</h6>
                  <select id="workspaceSelect" class="form-control mb-2"></select>
                </div>
              </div>
            </div>
          </div>

          <!-- Project and Task Selection (Always Visible After Setup) -->
<!--
          <div id="projectTaskSelection" class="card mb-3" style="display: none;">
            <div class="card-body">
              <h6 class="card-title">Select Project and Task</h6>
              <select id="projectSelect" class="form-control mb-2">
                <option value="">Select Project</option>
              </select>
              <select id="taskSelect" class="form-control mb-2">
                <option value="">Select Task</option>
              </select>
              <button id="addNewTaskButton" class="btn btn-secondary mb-2">Add New Task</button>
              <div id="newTaskForm" style="display: none;">
                <input type="text" class="form-control mb-2" id="newTaskName" placeholder="Enter new task name" />
                <button id="saveNewTask" class="btn btn-primary">Save Task</button>
              </div>
              <div id="newTaskMessageArea" style="display: none; margin-top: 10px;"></div>
              <h6 class="mt-3">Select Tags</h6>
              <select id="tagSelect" multiple class="form-control mb-2" size="8"></select>
              <h6>Enter Description</h6>
              <input type="text" class="form-control mb-2" id="description" placeholder="Enter description" />
              <h6>Start Time (Local Time Zone)</h6>
              <input type="datetime-local" class="form-control mb-2" id="startTime" />
              <h6>End Time (Local Time Zone)</h6>
              <input type="datetime-local" class="form-control mb-2" id="endTime" />
            </div>
          </div>
-->
					<div class="card mb-3">
						<div class="card-header" id="projectTaskHeader">
								<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse" data-target="#projectTaskCollapse" aria-expanded="false" aria-controls="projectTaskCollapse">
												<b>Project and Task Selection</b>
										</button>
								</h5>
						</div>
						<div id="projectTaskCollapse" class="collapse" aria-labelledby="projectTaskHeader">
								<div class="card-body">
										<h6 class="card-title">Select Project and Task</h6>
										<select id="projectSelect" class="form-control mb-2">
												<option value="">Select Project</option>
										</select>
										<select id="taskSelect" class="form-control mb-2">
												<option value="">Select Task</option>
										</select>
										<button id="addNewTaskButton" class="btn btn-secondary mb-2">Add New Task</button>
										<div id="newTaskForm" style="display: none;">
												<input type="text" class="form-control mb-2" id="newTaskName" placeholder="Enter new task name" />
												<button id="saveNewTask" class="btn btn-primary">Save Task</button>
										</div>
										<div id="newTaskMessageArea" style="display: none; margin-top: 10px;"></div>
										<h6 class="mt-3">Select Tags</h6>
										<select id="tagSelect" multiple class="form-control mb-2" size="8"></select>
										<h6>Enter Description</h6>
										<input type="text" class="form-control mb-2" id="description" placeholder="Enter description" />
										<h6>Start Time (Local Time Zone)</h6>
										<input type="datetime-local" class="form-control mb-2" id="startTime" />
										<h6>End Time (Local Time Zone)</h6>
										<input type="datetime-local" class="form-control mb-2" id="endTime" />
								</div>
						</div>
					</div>					
          <div class="text-center mt-3">
            <button id="createTimeEntry" class="btn btn-success btn-lg">Create Clockify Entry</button>
            <div id="messageArea" style="display: none; margin-top: 10px;"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Include Bootstrap JS for collapse functionality -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="taskpane.js"></script>
</body>
</html>